/*!
 * @pixi/canvas-graphics - v6.3.2
 * Compiled Wed, 04 May 2022 17:49:13 UTC
 *
 * @pixi/canvas-graphics is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
import{Texture as e,RenderTexture as t}from"@pixi/core";import{Matrix as i,SHAPES as r}from"@pixi/math";import{canvasUtils as a,CanvasRenderer as o}from"@pixi/canvas-renderer";import{Graphics as l}from"@pixi/graphics";var n,s=function(){function e(){}return e.offsetPolygon=function(t,i){var r=[],a=t.length;i=e.isPolygonClockwise(t)?i:-1*i;for(var o=0;o<a;o+=2){var l=o-2;l<0&&(l+=a);var n=(o+2)%a,s=t[o]-t[l],h=t[o+1]-t[l+1],v=Math.sqrt(s*s+h*h);s/=v,h/=v;var g=-(h*=i),p=s*=i,f=[t[l]+g,t[l+1]+p],c=[t[o]+g,t[o+1]+p],u=t[n]-t[o],d=t[n+1]-t[o+1];u/=v=Math.sqrt(u*u+d*d),d/=v;var m=-(d*=i),T=u*=i,y=[t[o]+m,t[o+1]+T],x=[t[n]+m,t[n+1]+T],b=e.findIntersection(f[0],f[1],c[0],c[1],y[0],y[1],x[0],x[1]);b&&r.push.apply(r,b)}return r},e.findIntersection=function(e,t,i,r,a,o,l,n){var s=(n-o)*(i-e)-(l-a)*(r-t),h=(l-a)*(t-o)-(n-o)*(e-a);if(0===s)return 0===h&&0===(i-e)*(t-o)-(r-t)*(e-a)?[(e+i)/2,(t+r)/2]:null;var v=h/s;return[e+v*(i-e),t+v*(r-t)]},e.isPolygonClockwise=function(e){for(var t=0,i=0,r=e.length-2;i<e.length;r=i,i+=2)t+=(e[i]-e[r])*(e[i+1]+e[r+1]);return t>0},e}(),h=function(){function t(e){this._svgMatrix=null,this._tempMatrix=new i,this.renderer=e}return t.prototype._calcCanvasStyle=function(t,r){var o;return t.texture&&t.texture.baseTexture!==e.WHITE.baseTexture?t.texture.valid?(o=a.getTintedPattern(t.texture,r),this.setPatternTransform(o,t.matrix||i.IDENTITY)):o="#808080":o="#"+("00000"+(0|r).toString(16)).slice(-6),o},t.prototype.render=function(e){var t=this.renderer,i=t.context,a=e.worldAlpha,o=e.transform.worldTransform;t.setContextTransform(o),t.setBlendMode(e.blendMode);for(var l,n,s=e.geometry.graphicsData,h=(e.tint>>16&255)/255,v=(e.tint>>8&255)/255,g=(255&e.tint)/255,p=0;p<s.length;p++){var f=s[p],c=f.shape,u=f.fillStyle,d=f.lineStyle,m=0|f.fillStyle.color,T=0|f.lineStyle.color;if(f.matrix&&t.setContextTransform(o.copyTo(this._tempMatrix).append(f.matrix)),u.visible){var y=((m>>16&255)/255*h*255<<16)+((m>>8&255)/255*v*255<<8)+(255&m)/255*g*255;l=this._calcCanvasStyle(u,y)}if(d.visible){var x=((T>>16&255)/255*h*255<<16)+((T>>8&255)/255*v*255<<8)+(255&T)/255*g*255;n=this._calcCanvasStyle(d,x)}if(i.lineWidth=d.width,i.lineCap=d.cap,i.lineJoin=d.join,i.miterLimit=d.miterLimit,f.type===r.POLY){i.beginPath();var b=(A=c).points,P=f.holes,M=void 0,C=void 0,S=void 0,w=void 0,_=void 0;i.moveTo(b[0],b[1]);for(var k=2;k<b.length;k+=2)i.lineTo(b[k],b[k+1]);if(A.closeStroke&&i.closePath(),P.length>0){_=[],M=0,S=b[0],w=b[1];for(k=2;k+2<b.length;k+=2)M+=(b[k]-S)*(b[k+3]-w)-(b[k+2]-S)*(b[k+1]-w);for(var R=0;R<P.length;R++)if(b=P[R].shape.points){C=0,S=b[0],w=b[1];for(k=2;k+2<b.length;k+=2)C+=(b[k]-S)*(b[k+3]-w)-(b[k+2]-S)*(b[k+1]-w);if(C*M<0){i.moveTo(b[0],b[1]);for(k=2;k<b.length;k+=2)i.lineTo(b[k],b[k+1])}else{i.moveTo(b[b.length-2],b[b.length-1]);for(k=b.length-4;k>=0;k-=2)i.lineTo(b[k],b[k+1])}P[R].shape.closeStroke&&i.closePath(),_[R]=C*M<0}}u.visible&&(i.globalAlpha=u.alpha*a,i.fillStyle=l,i.fill()),d.visible&&this.paintPolygonStroke(A,d,n,P,_,a,i)}else if(f.type===r.RECT){var A=c;if(u.visible&&(i.globalAlpha=u.alpha*a,i.fillStyle=l,i.fillRect(A.x,A.y,A.width,A.height)),d.visible){var q=d.width*(.5-(1-d.alignment)),E=A.width+2*q,I=A.height+2*q;i.globalAlpha=d.alpha*a,i.strokeStyle=n,i.strokeRect(A.x-q,A.y-q,E,I)}}else if(f.type===r.CIRC){A=c;if(i.beginPath(),i.arc(A.x,A.y,A.radius,0,2*Math.PI),i.closePath(),u.visible&&(i.globalAlpha=u.alpha*a,i.fillStyle=l,i.fill()),d.visible){if(.5!==d.alignment){q=d.width*(.5-(1-d.alignment));i.beginPath(),i.arc(A.x,A.y,A.radius+q,0,2*Math.PI),i.closePath()}i.globalAlpha=d.alpha*a,i.strokeStyle=n,i.stroke()}}else if(f.type===r.ELIP){A=c;if((J=1===d.alignment)||this.paintEllipse(A,u,d,l,a,i),d.visible){if(.5!==d.alignment){var z=.5522848,L=(q=d.width*(.5-(1-d.alignment)),2*(A.width+q)),D=2*(A.height+q),G=A.x-L/2,B=A.y-D/2,N=L/2*z,V=D/2*z,W=G+L,Y=B+D,j=G+L/2,H=B+D/2;i.beginPath(),i.moveTo(G,H),i.bezierCurveTo(G,H-V,j-N,B,j,B),i.bezierCurveTo(j+N,B,W,H-V,W,H),i.bezierCurveTo(W,H+V,j+N,Y,j,Y),i.bezierCurveTo(j-N,Y,G,H+V,G,H),i.closePath()}i.globalAlpha=d.alpha*a,i.strokeStyle=n,i.stroke()}J&&this.paintEllipse(A,u,d,l,a,i)}else if(f.type===r.RREC){var J;A=c;if((J=1===d.alignment)||this.paintRoundedRectangle(A,u,d,l,a,i),d.visible){if(.5!==d.alignment){E=A.width,I=A.height,q=d.width*(.5-(1-d.alignment));var O=A.x-q,F=A.y-q,K=A.width+2*q,Q=A.height+2*q,U=q*(d.alignment>=1?Math.min(K/E,Q/I):Math.min(E/K,I/Q)),X=A.radius+U,Z=Math.min(K,Q)/2;X=X>Z?Z:X,i.beginPath(),i.moveTo(O,F+X),i.lineTo(O,F+Q-X),i.quadraticCurveTo(O,F+Q,O+X,F+Q),i.lineTo(O+K-X,F+Q),i.quadraticCurveTo(O+K,F+Q,O+K,F+Q-X),i.lineTo(O+K,F+X),i.quadraticCurveTo(O+K,F,O+K-X,F),i.lineTo(O+X,F),i.quadraticCurveTo(O,F,O,F+X),i.closePath()}i.globalAlpha=d.alpha*a,i.strokeStyle=n,i.stroke()}J&&this.paintRoundedRectangle(A,u,d,l,a,i)}}},t.prototype.paintPolygonStroke=function(e,t,i,r,a,o,l){if(.5!==t.alignment){var n=t.width*(.5-(1-t.alignment)),h=s.offsetPolygon(e.points,n),v=void 0;l.beginPath(),l.moveTo(h[0],h[1]);for(var g=2;g<h.length;g+=2)l.lineTo(h[g],h[g+1]);e.closeStroke&&l.closePath();for(var p=0;p<r.length;p++){if(v=r[p].shape.points,h=s.offsetPolygon(v,n),a[p]){l.moveTo(h[0],h[1]);for(g=2;g<h.length;g+=2)l.lineTo(h[g],h[g+1])}else{l.moveTo(h[h.length-2],h[h.length-1]);for(g=h.length-4;g>=0;g-=2)l.lineTo(h[g],h[g+1])}r[p].shape.closeStroke&&l.closePath()}}l.globalAlpha=t.alpha*o,l.strokeStyle=i,l.stroke()},t.prototype.paintEllipse=function(e,t,i,r,a,o){var l=2*e.width,n=2*e.height,s=e.x-l/2,h=e.y-n/2,v=.5522848,g=l/2*v,p=n/2*v,f=s+l,c=h+n,u=s+l/2,d=h+n/2;0===i.alignment&&o.save(),o.beginPath(),o.moveTo(s,d),o.bezierCurveTo(s,d-p,u-g,h,u,h),o.bezierCurveTo(u+g,h,f,d-p,f,d),o.bezierCurveTo(f,d+p,u+g,c,u,c),o.bezierCurveTo(u-g,c,s,d+p,s,d),o.closePath(),0===i.alignment&&o.clip(),t.visible&&(o.globalAlpha=t.alpha*a,o.fillStyle=r,o.fill()),0===i.alignment&&o.restore()},t.prototype.paintRoundedRectangle=function(e,t,i,r,a,o){var l=e.x,n=e.y,s=e.width,h=e.height,v=e.radius,g=Math.min(s,h)/2;v=v>g?g:v,0===i.alignment&&o.save(),o.beginPath(),o.moveTo(l,n+v),o.lineTo(l,n+h-v),o.quadraticCurveTo(l,n+h,l+v,n+h),o.lineTo(l+s-v,n+h),o.quadraticCurveTo(l+s,n+h,l+s,n+h-v),o.lineTo(l+s,n+v),o.quadraticCurveTo(l+s,n,l+s-v,n),o.lineTo(l+v,n),o.quadraticCurveTo(l,n,l,n+v),o.closePath(),0===i.alignment&&o.clip(),t.visible&&(o.globalAlpha=t.alpha*a,o.fillStyle=r,o.fill()),0===i.alignment&&o.restore()},t.prototype.setPatternTransform=function(e,t){if(!1!==this._svgMatrix){if(!this._svgMatrix){var i=document.createElementNS("http://www.w3.org/2000/svg","svg");if(i&&i.createSVGMatrix&&(this._svgMatrix=i.createSVGMatrix()),!this._svgMatrix||!e.setTransform)return void(this._svgMatrix=!1)}this._svgMatrix.a=t.a,this._svgMatrix.b=t.b,this._svgMatrix.c=t.c,this._svgMatrix.d=t.d,this._svgMatrix.e=t.tx,this._svgMatrix.f=t.ty,e.setTransform(this._svgMatrix.inverse())}},t.prototype.destroy=function(){this.renderer=null,this._svgMatrix=null,this._tempMatrix=null},t}(),v=new i;l.prototype.generateCanvasTexture=function(i,r){void 0===r&&(r=1);var a=this.getLocalBounds(),l=t.create({width:a.width,height:a.height,scaleMode:i,resolution:r});n||(n=new o),this.transform.updateLocalTransform(),this.transform.localTransform.copyTo(v),v.invert(),v.tx-=a.x,v.ty-=a.y,n.render(this,{renderTexture:l,clear:!0,transform:v});var s=e.from(l.baseTexture._canvasRenderTarget.canvas,{scaleMode:i});return s.baseTexture.setResolution(r),s},l.prototype.cachedGraphicsData=[],l.prototype._renderCanvas=function(e){!0!==this.isMask&&(this.finishPoly(),e.plugins.graphics.render(this))};export{h as CanvasGraphicsRenderer};
//# sourceMappingURL=canvas-graphics.min.js.map
